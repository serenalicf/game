<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Snake Game</title>
    <style>
        canvas { background: #222; display: block; margin: 20px auto; }
        #game-over { color: red; text-align: center; font-size: 2em; }
        #start-btn { display: block; margin: 10px auto; }
    </style>
</head>
<body>
    <button id="start-btn">Start Game</button>
    <div id="game-over"></div>
    <canvas id="game-canvas" width="400" height="400"></canvas>
    <script>
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const boardSize = 20;
        const cellSize = canvas.width / boardSize;
        let direction = 'RIGHT';
        let gameOver = false;
        let intervalId = null;

        document.getElementById('start-btn').onclick = startGame;

        document.addEventListener('keydown', e => {
            if (gameOver) return;
            switch (e.key) {
                case 'ArrowUp':    direction = 'UP'; break;
                case 'ArrowDown':  direction = 'DOWN'; break;
                case 'ArrowLeft':  direction = 'LEFT'; break;
                case 'ArrowRight': direction = 'RIGHT'; break;
            }
        });

        function startGame() {
            fetch('/api/snake/start', { method: 'POST' })
                .then(() => {
                    direction = 'RIGHT';
                    gameOver = false;
                    document.getElementById('game-over').textContent = '';
                    if (intervalId) clearInterval(intervalId);
                    intervalId = setInterval(gameLoop, 150);
                });
        }

        function gameLoop() {
            fetch(`/api/snake/move?direction=${direction}`, { method: 'POST' })
                .then(() => fetch('/api/snake/state'))
                .then(res => res.json())
                .then(drawGame);
        }

        function drawGame(state) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw food
            ctx.fillStyle = 'red';
            ctx.fillRect(state.food.x * cellSize, state.food.y * cellSize, cellSize, cellSize);

            // Draw snake
            ctx.fillStyle = 'lime';
            state.snake.forEach(part => {
                ctx.fillRect(part.x * cellSize, part.y * cellSize, cellSize, cellSize);
            });

            if (state.gameOver) {
                document.getElementById('game-over').textContent = 'Game Over!';
                clearInterval(intervalId);
                gameOver = true;
            }
        }
    </script>
</body>
</html> 